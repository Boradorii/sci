{% extends "templates/appmainbase.html" %}
<!-- ------------------------------------------------------------- -->
{% block head %}
<!-- CSS -->
<!-- datepicker CSS -->
<link href="/assets/node_modules/bootstrap-material-datetimepicker/css/bootstrap-material-datetimepicker.css"
    rel="stylesheet">
<link href="/assets/node_modules/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="/assets/icons/material-design-iconic-font/css/material-design-iconic-font.css">

<style>
    .card-box {
        width: 100%;
        margin-top: 45px;
        margin-bottom: 0px;
        border: 2px solid lightgray;
    }

    .container-fluid {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .p_down {
        /* border-top: 1px solid lightgray; */
        width: 100%;
        margin: 7px;
        font-size: 15pt;
        font-weight: bold;
        font-display: center;

    }
</style>
{%endblock%}
<!-- ------------------------------------------------------------- -->



<!-- ------------------------------------------------------------- -->
<!-- Content ì‹œì‘ -->
{% block contents%}
<!-- html -->
<div class="skin-megna page-wrapper" style="padding: 0; overflow-y: scroll;">
    <div class="container-fluid">

        <!-- ë³‘ì› ì°¾ê¸° -->
        <div class="card card-box buttonList" id="go-findHos"
            style="text-align: center; background-size: cover; background-repeat: no-repeat;background-image:url(/images/icon/map1.jpg); width: 100%;">
            <div style="width: 100%; padding: 0px;">
                <!-- <img src="/images/icon/find-vet.jpg" style="width:100px; height:100px;margin-top: 10px;"> -->
                <!-- <h6 style="font-weight: 700; margin-top: 20px;">ì´ë¯¸ì§€</h6> -->
                <div class="row" style="display: flex; justify-content: center; width: 100%; margin: 30px 0px;">
                    <div class="p_down" id="findHospital">ë³‘ì›ì°¾ê¸°ğŸ”</div>
                </div>
            </div>
        </div>
        <!-- ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì› -->
        <div class="card card-box buttonList" id="go-visitHos"
            style="text-align: center; margin-bottom: 0px; background-size: cover; background-repeat: no-repeat;background-image:url(/images/icon/hp.jpg); width: 100%;">
        </div>




        <!-- ì¸¡ì • ê¸°ë¡ ì¡°íšŒ -->

        <div class="card card-box buttonList" id="go-treatList"
            style="text-align: center;  background-size:cover; background-repeat: no-repeat;background-image:url(/images/icon/bg.png); width: 100%;">
            <div>
                <!-- <img src="/images/icon/treat-list.jpg" style="width:100px; height:100px;margin-top: 10px;"> -->
                <!-- <h6 style="font-weight: 700; margin-top: 20px;">ì´ë¯¸ì§€</h6> -->
                <div class="row" style="display: flex; justify-content: center; width: 100%; margin: 30px 0px;">
                    <p class="p_down" id="hospitalRecord">ì§„ë£Œ ë‚´ì—­ğŸ“</p>
                </div>
            </div>
        </div>

        <div class="card card-box buttonList" id="go-inquiryList"
            style="text-align: center;  background-size: cover; background-repeat: no-repeat;background-image:url(/images/icon/qs.png); width: 100%;">
            <div>
                <!-- <img src="/images/icon/treat-list.jpg" style="width:100px; height:100px;margin-top: 10px;"> -->
                <!-- <h6 style="font-weight: 700; margin-top: 20px;">ì´ë¯¸ì§€</h6> -->
                <div class="row" style="display: flex; justify-content: center; width: 100%; margin: 30px 0px;">
                    <p class="p_down" id="inquiryRecord">ë¬¸ì˜ ë‚´ì—­ğŸ’¬</p>
                </div>
            </div>
        </div>

    </div>
</div>



{% endblock %}
<!-- ------------------------------------------------------------- -->



<!-- ------------------------------------------------------------- -->
{% block script %}
<script src="/assets/node_modules/moment/moment.js"></script>
<script src="/assets/node_modules/Chart.js/Chart.min.js"></script>
<script>
    let p_userCode = '{{p_userCode}}',
        visitHos = '{{visitHos|safe}}';
    visitHos = JSON.parse(visitHos)
    console.log(visitHos)
</script>
<script>
    //ì•±>> í˜ì´ì§€ ì´ë™ ì‹œ í•„ìˆ˜ ì‘ì„±(ë’¤ë¡œê°€ê¸° ë²„íŠ¼ êµ¬í˜„ì‹œ í•„ìš”)
    window.parent.postMessage({
        action: 'moveFrameN'
    }, '*'); // TO-DO: ì„ì‹œë¡œ ëª¨ë“  ë„ë©”ì¸ í—ˆìš©(*)í•˜ì˜€ìŒ. ì¶”í›„ ìˆ˜ì •í•  ê²ƒ
    //ì•±>> í˜ì´ì§€ ì´ë™ ì‹œ í•„ìˆ˜ ì‘ì„±(ë’¤ë¡œê°€ê¸° ë²„íŠ¼ êµ¬í˜„ì‹œ í•„ìš”)

    //ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì› í‘œì‹œ
    let hosRecord
    if (visitHos.rowLength > 0) {
        $('#go-visitHos').html('')
        hosRecord = `<div class="hosRecord" id=${visitHos.rows[0].h_user_code}>
                <div class="card-title" style="font-weight: 700; font-size: 15pt; margin-top: 20px;">ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì›ğŸ£</div>
                <div class="row" style="display: flex; justify-content: center; margin-top: 10px; width: 100%; margin: 20px 0px;">
                    <span id="hosRecordName">${visitHos.rows[0].h_name}</span>
                    <span>ë°©ë¬¸ì¼ | <span id="hosRecordDate"></span> ${visitHos.rows[0].medi_created_time.slice(0, 10)}</span>
                </div>
            </div>`
    } else {
        hosRecord = `<div class="hosRecord">
                <div class="h4 card-title" style="font-weight: 700; margin-top: 10px;">ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì›</div>
                <div class="row" style="display: flex; justify-content: center; margin-top: 10px; width: 100%; margin: 20px 0px;">
                    <span id="hosRecordName">ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì› ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</span>
                </div>
            </div>`
    };
    $('#go-visitHos').html(hosRecord);
    //ìµœê·¼ ë°©ë¬¸í•œ ë™ë¬¼ë³‘ì› í‘œì‹œ


    // í˜ì´ì§€ ì´ë™ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ 2021.05.10 JG
    $(".buttonList").on('click', function (evnt) {
        let targetId = evnt.currentTarget.id,
            reqUrl = baseUrl + '/a_hospital';
        switch (targetId) {
            case 'go-findHos':
                reqUrl += '/findHosPage';
                window.parent.postMessage({ // ì•± ìƒë‹¨ íƒ€ì´í‹€ ë³€ê²½ì„ ìœ„í•œ postMessage ì „ì†¡
                    action: 'go-findHos'
                }, '*');
                reqUrl += '?p_userCode=' + p_userCode /* + '&lang=' + lang + "&accessToken=" + accessToken*/;

                location.href = reqUrl;
                break;
            case 'go-visitHos':
                if (typeof $('.hosRecord').attr('id') != undefined) {
                    reqUrl += '/hosInfoPage?p_userCode=' + p_userCode + '&h_userCode=' + $('.hosRecord').attr('id');
                    window.parent.postMessage({ // ì•± ìƒë‹¨ íƒ€ì´í‹€ ë³€ê²½ì„ ìœ„í•œ postMessage ì „ì†¡
                        action: 'go-hosInfo'
                    }, '*');
                    location.href = reqUrl;
                }
                break;

            case 'go-treatList':
                reqUrl += '/treatListPage';
                window.parent.postMessage({ // ì•± ìƒë‹¨ íƒ€ì´í‹€ ë³€ê²½ì„ ìœ„í•œ postMessage ì „ì†¡
                    action: 'go-treatList'
                }, '*');
                reqUrl += '?p_userCode=' + p_userCode /* + '&lang=' + lang + "&accessToken=" + accessToken*/;

                location.href = reqUrl;
                break;

            case 'go-inquiryList':
                reqUrl += '/loadInquiryListPage';
                window.parent.postMessage({ // ì•± ìƒë‹¨ íƒ€ì´í‹€ ë³€ê²½ì„ ìœ„í•œ postMessage ì „ì†¡
                    action: 'go-inquiryList'
                }, '*');
                reqUrl += '?p_userCode=' + p_userCode /* + '&lang=' + lang + "&accessToken=" + accessToken*/;

                location.href = reqUrl;
                break;

        }

        //ì•±>> í˜ì´ì§€ ì´ë™ ì‹œ í•„ìˆ˜ ì‘ì„±(ë’¤ë¡œê°€ê¸° ë²„íŠ¼ êµ¬í˜„ì‹œ í•„ìš”)
        window.parent.postMessage({
            action: 'moveFrameY' //ë©”ì¸í˜ì´ì§€ì—ì„œ í•˜ìœ„ ë©”ë‰´ë¡œ ë“¤ì–´ê°”ì„ ë•Œ í˜ì´ì§€ ì´ë™ í‘œì‹œ("Y": í•˜ìœ„ ë©”ë‰´/"N": ë©”ì¸ë©”ë‰´)
        }, '*'); // TO-DO: ì„ì‹œë¡œ ëª¨ë“  ë„ë©”ì¸ í—ˆìš©(*)í•˜ì˜€ìŒ. ì¶”í›„ ìˆ˜ì •í•  ê²ƒ

        //ì•±>> í˜ì´ì§€ ì´ë™ ì‹œ í•„ìˆ˜ ì‘ì„±(ë’¤ë¡œê°€ê¸° ë²„íŠ¼ êµ¬í˜„ì‹œ í•„ìš”)

    });
</script>

{% endblock %}